var m=Object.defineProperty;var p=(t,e,o)=>e in t?m(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var a=(t,e,o)=>p(t,typeof e!="symbol"?e+"":e,o);import{i as h}from"./shared-orbitcontrols-CgIe_u_6.js";import"./vendor-three-D5KETS6T.js";import"./gainmap-js-CNO3VnAy.js";import"./postprocessing-DA0fEaQl.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function o(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=o(n);fetch(n.href,r)}})();const l=class l{constructor(e,o,s){a(this,"id");a(this,"worker");a(this,"element");a(this,"resizeObserver");this.id=l.nextId++,this.worker=o,this.element=e;const n=c=>{this.worker.postMessage({type:"event",id:this.id,data:c})};this.worker.postMessage({type:"makeProxy",id:this.id});const r=()=>{const c=this.element.getBoundingClientRect();n({type:"size",left:c.left,top:c.top,width:this.element.clientWidth,height:this.element.clientHeight,pixelRatio:window.devicePixelRatio||1})};this.resizeObserver=new ResizeObserver(()=>{requestAnimationFrame(r)}),r(),this.resizeObserver.observe(e),this.attachHandlers(s,n)}attachHandlers(e,o){Object.entries(e).forEach(([s,n])=>{this.element.addEventListener(s,r=>{const c=n(r);o(c)})})}disconnect(){this.resizeObserver.disconnect()}};a(l,"nextId",0);let d=l;function i(t){return e=>t(e)}function f(t){return e=>{const o={type:e.type};return t.forEach(s=>{s in e&&(o[s]=e[s])}),o}}function v(){return t=>(t.preventDefault(),{type:t.type,touches:Array.from(t.touches).map(e=>({pageX:e.pageX,pageY:e.pageY,clientX:e.clientX,clientY:e.clientY}))})}const g=()=>{const t=f(["ctrlKey","metaKey","shiftKey","button","pointerType","clientX","clientY","pointerId","pageX","pageY"]),e=v();return{contextmenu:i(o=>(o.preventDefault(),{type:o.type})),mousedown:i(t),mousemove:i(t),mouseup:i(t),mouseleave:i(t),pointerdown:i(t),pointermove:i(t),pointerup:i(t),pointerout:i(t),wheel:i(o=>(o.preventDefault(),{type:o.type,deltaX:o.deltaX,deltaY:o.deltaY})),touchstart:i(e),touchmove:i(e),touchend:i(e),keydown:i(o=>({type:o.type,key:o.key,ctrlKey:o.ctrlKey,metaKey:o.metaKey,shiftKey:o.shiftKey}))}};function u(){const t=/Macintosh(?!.*KHTML).*Gecko/i.test(navigator.userAgent),e=/Android(?!.*KHTML).*Gecko/i.test(navigator.userAgent);return t||e?{disableMSAA:!0,lowResolution:!0}:{disableMSAA:!1,lowResolution:!1}}function y(t){const e=t.transferControlToOffscreen(),o=new Worker(new URL("/monk-viewer/assets/offscreencanvas-worker-orbitcontrol-C4TKs0o5.js",import.meta.url),{type:"module"}),s=new d(t,o,g());o.postMessage({type:"start",canvas:e,canvasId:s.id,pixelRatio:window.devicePixelRatio||1,lowPerformanceSettings:u()},[e])}function w(){const t=document.querySelector("#c");t&&(t.transferControlToOffscreen!==void 0?y(t):h({canvas:t,inputElement:t,pixelRatio:window.devicePixelRatio,lowPerformanceSettings:u()}))}w();class b extends HTMLElement{constructor(){super();a(this,"canvas");a(this,"modelUrl");a(this,"maxZoom");a(this,"minZoom");a(this,"envmapUrl");this.canvas=null,this.modelUrl=this.getAttribute("model")||"",this.maxZoom=parseFloat(this.getAttribute("max-zoom")||"1.0"),this.minZoom=parseFloat(this.getAttribute("min-zoom")||"0.1"),this.envmapUrl=this.getAttribute("envmap")||""}connectedCallback(){this.createCanvas(),this.logAttributes()}logAttributes(){console.log("Model URL:",this.modelUrl),console.log("Max Zoom:",this.maxZoom),console.log("Min Zoom:",this.minZoom),console.log("Envmap URL:",this.envmapUrl)}createCanvas(){if(!this.canvas){if(this.canvas=document.createElement("canvas"),this.canvas.style.width="100%",this.canvas.style.height="100%",this.appendChild(this.canvas),!(this.canvas.getContext("webgl")||this.canvas.getContext("2d"))){console.error("Unable to initialize canvas context.");return}console.log("Canvas initialized.")}}}customElements.define("monk-view",b);
