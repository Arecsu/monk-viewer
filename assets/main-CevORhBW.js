import{i as u}from"./shared-orbitcontrols-B4h4boGd.js";import"./vendor-three-B2nca_jY.js";import"./gainmap-js-DC9a5eKy.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function i(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(t){if(t.ep)return;t.ep=!0;const o=i(t);fetch(t.href,o)}})();const c=a(["ctrlKey","metaKey","shiftKey","button","pointerType","clientX","clientY","pointerId","pageX","pageY"]),f=a(["deltaX","deltaY"]),p=a(["ctrlKey","metaKey","shiftKey","keyCode"]);function h(e,n){e.preventDefault(),f(e,n)}function m(e,n){n({type:e.type})}function y(e,n,i){for(const r of n)i[r]=e[r]}function a(e){return function(i,r){const t={type:i.type};y(i,e,t),r(t)}}function l(e,n){e.preventDefault();const i=[],r={type:e.type,touches:i};for(let t=0;t<e.touches.length;++t){const o=e.touches[t];i.push({pageX:o.pageX,pageY:o.pageY,clientX:o.clientX,clientY:o.clientY})}n(r)}const g={37:!0,38:!0,39:!0,40:!0};function v(e,n){const{keyCode:i}=e;g[i]&&(e.preventDefault(),p(e,n))}let w=0;class O{constructor(n,i,r){this.id=w++,this.worker=i,this.element=n;const t=o=>{this.worker.postMessage({type:"event",id:this.id,data:o})};i.postMessage({type:"makeProxy",id:this.id}),this.resizeObserver=new ResizeObserver(o=>{requestAnimationFrame(()=>{const s=this.element.getBoundingClientRect();t({type:"size",left:s.left,top:s.top,width:this.element.clientWidth,height:this.element.clientHeight,pixelRatio:window.devicePixelRatio||1})})}),this.sendSize(t),this.resizeObserver.observe(n);for(const[o,s]of Object.entries(r))n.addEventListener(o,function(d){s(d,t)})}sendSize(n){const i=this.element.getBoundingClientRect();n({type:"size",left:i.left,top:i.top,width:this.element.clientWidth,height:this.element.clientHeight})}disconnect(){this.resizeObserver&&this.resizeObserver.disconnect()}}function b(e){const n=e.transferControlToOffscreen(),i=new Worker(new URL("/monk-viewer/assets/offscreencanvas-worker-orbitcontrol-bL5zjLMB.js",import.meta.url),{type:"module"}),r=window.devicePixelRatio||1,t={contextmenu:m,mousedown:c,mousemove:c,mouseup:c,mouseleave:c,pointerdown:c,pointermove:c,pointerup:c,touchstart:l,touchmove:l,touchend:l,wheel:h,keydown:v},o=new O(e,i,t);i.postMessage({type:"start",canvas:n,canvasId:o.id,pixelRatio:r},[n]),console.log("using OffscreenCanvas")}function P(e){u({canvas:e,inputElement:e,pixelRatio:window.devicePixelRatio}),console.log("using regular canvas")}function x(){const e=document.querySelector("#c");e.transferControlToOffscreen?b(e):P(e)}x();
