import{a as _,m as I,n as J,o as N,S as V,p as X,q as Y,G as K,A as Q,H as y,r as k,L,E as Z,s as $,W as ee,b as te,t as se,u as ne,v as ae,w as ie,x as oe,y as re}from"./vendor-three-CbQP5_YZ.js";import{H as ce}from"./gainmap-js-DfMKbIFV.js";const le="/monk-viewer/assets/McLovin-1024x-DrI75Pld.glb",pe="/monk-viewer/assets/old_bus_depot_2k_HDR-CghB0eNo.jpg";function ue(R){let{canvas:j,inputElement:i,pixelRatio:m}=R;const r=new _({powerPreference:"high-performance",antialias:!1,canvas:j});m=1,r.setPixelRatio(m||1),r.toneMapping=I,r.toneMappingExposure=1.5;const S=50,H=2,O=.1,C=100,c=new J(S,H,O,C);c.position.z=.8;const p=new N(c,i);p.enableDamping=!0,p.dampingFactor=.055,p.target.set(0,0,0),p.update();const l=new V,z=16777215,D=1,E=new X(z,D);l.background=new Y(0),E.position.set(-10,5,40);let u,g=Date.now(),v;new K().load(le,async function(e){const n=e.scene;n.scale.set(1,1,1),n.traverse(t=>{if(t.material&&(t.material.needsUpdate=!0,t.material.onBeforeCompile=a=>{console.log(a)}),t.isMesh){t.receiveShadow=!1;const a=o=>{o&&(o.minFilter=k,o.magFilter=L,o.anisotropy=r.capabilities.getMaxAnisotropy(),o.generateMipmaps=!0)};a(t.material.map),a(t.material.normalMap),a(t.material.roughnessMap),a(t.material.metalnessMap)}}),await r.compileAsync(n,c,l),u=new Q(n),u.clipAction(e.animations[0]),l.add(n),requestAnimationFrame(P)}),new ce(r).load(pe,function(e){const n=e.renderTarget.texture;n.type=y,n.minFilter=k,n.magFilter=L,n.generateMipmaps=!0,n.needsUpdate=!0,l.environment=n,l.environment.mapping=Z,e.dispose()});const h=r.getDrawingBufferSize(new $),w=new ee(h.width,h.height,{samples:8,anisotropy:r.capabilities.getMaxAnisotropy(),colorSpace:te,type:y}),d=new se(r,w),b=new ne(l,c);d.addPass(b);const F=new ae(h,.12,.9,.1);d.addPass(F);const T=new ie;d.addPass(T);const A=1,B=1,G=1;new oe(A,B,G);class W{constructor(){this.raycaster=new re,this.pickedObject=null,this.pickedObjectSavedColor=0}pick(e,n,t,a){this.pickedObject&&(this.pickedObject.material.emissive.setHex(this.pickedObjectSavedColor),this.pickedObject=void 0),this.raycaster.setFromCamera(e,t);const o=this.raycaster.intersectObjects(n.children);o.length&&(this.pickedObject=o[0].object,this.pickedObjectSavedColor=this.pickedObject.material.emissive.getHex(),this.pickedObject.material.emissive.setHex(a*8%2>1?16776960:16711680))}}new W;let x=0;function q(s,e){if(e-x<150)return!1;const n=s.domElement,t=i.clientWidth,a=i.clientHeight,o=n.width!==Math.floor(t*m)||n.height!==Math.floor(a*m);return o&&(x=e,s.setSize(t,a,!1),w.setSize(t,a,!1),d.setSize(t,a),b.setSize(t,a),F.resolution.set(t,a)),o}function P(s){const e=Date.now();q(r,e)&&(c.aspect=i.clientWidth/i.clientHeight,c.updateProjectionMatrix()),v=(e-g)/1e3,u&&u.update(v),p.update(),d.render(),g=e,requestAnimationFrame(P)}function U(s){const e=i.getBoundingClientRect();return{x:s.clientX-e.left,y:s.clientY-e.top}}function f(s){const e=U(s);e.x/i.clientWidth*2-1,e.y/i.clientHeight*-2+1}function M(){}i.addEventListener("mousemove",f),i.addEventListener("mouseout",M),i.addEventListener("mouseleave",M),i.addEventListener("touchstart",s=>{s.preventDefault(),f(s.touches[0])},{passive:!1}),i.addEventListener("touchmove",s=>{f(s.touches[0])}),i.addEventListener("touchend",s=>{})}export{ue as i};
