var f=Object.defineProperty;var p=(t,e,r)=>e in t?f(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var a=(t,e,r)=>p(t,typeof e!="symbol"?e+"":e,r);import{i as m}from"./shared-orbitcontrols-B40Jz_ST.js";import"./vendor-three-AsLCX2xS.js";import"./gainmap-js-BVpBP2_V.js";import"./postprocessing-B3RkHJSW.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function r(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(n){if(n.ep)return;n.ep=!0;const o=r(n);fetch(n.href,o)}})();const l=class l{constructor(e,r,s){a(this,"id");a(this,"worker");a(this,"element");a(this,"resizeObserver");this.id=l.nextId++,this.worker=r,this.element=e;const n=c=>{this.worker.postMessage({type:"event",id:this.id,data:c})};this.worker.postMessage({type:"makeProxy",id:this.id});const o=()=>{const c=this.element.getBoundingClientRect();n({type:"size",left:c.left,top:c.top,width:this.element.clientWidth,height:this.element.clientHeight,pixelRatio:window.devicePixelRatio||1})};this.resizeObserver=new ResizeObserver(()=>{requestAnimationFrame(o)}),o(),this.resizeObserver.observe(e),this.attachHandlers(s,n)}attachHandlers(e,r){Object.entries(e).forEach(([s,n])=>{this.element.addEventListener(s,o=>{const c=n(o);r(c)})})}disconnect(){this.resizeObserver.disconnect()}};a(l,"nextId",0);let d=l;function i(t){return e=>t(e)}function y(t){return e=>{const r={type:e.type};return t.forEach(s=>{s in e&&(r[s]=e[s])}),r}}function h(){return t=>(t.preventDefault(),{type:t.type,touches:Array.from(t.touches).map(e=>({pageX:e.pageX,pageY:e.pageY,clientX:e.clientX,clientY:e.clientY}))})}const v=()=>{const t=y(["ctrlKey","metaKey","shiftKey","button","pointerType","clientX","clientY","pointerId","pageX","pageY"]),e=h();return{contextmenu:i(r=>(r.preventDefault(),{type:r.type})),mousedown:i(t),mousemove:i(t),mouseup:i(t),mouseleave:i(t),pointerdown:i(t),pointermove:i(t),pointerup:i(t),wheel:i(r=>(r.preventDefault(),{type:r.type,deltaX:r.deltaX,deltaY:r.deltaY})),touchstart:i(e),touchmove:i(e),touchend:i(e),keydown:i(r=>({type:r.type,key:r.key,ctrlKey:r.ctrlKey,metaKey:r.metaKey,shiftKey:r.shiftKey}))}};function u(){const t=/Macintosh(?!.*KHTML).*Gecko/i.test(navigator.userAgent),e=/Android(?!.*KHTML).*Gecko/i.test(navigator.userAgent);return t||e?{disableMSAA:!0,lowResolution:!0}:{disableMSAA:!1,lowResolution:!1}}function g(t){const e=t.transferControlToOffscreen(),r=new Worker(new URL("/monk-viewer/assets/offscreencanvas-worker-orbitcontrol-wWVRTXsS.js",import.meta.url),{type:"module"}),s=new d(t,r,v());r.postMessage({type:"start",canvas:e,canvasId:s.id,pixelRatio:window.devicePixelRatio||1,lowPerformanceSettings:u()},[e])}function w(){const t=document.querySelector("#c");t&&(t.transferControlToOffscreen!==void 0?g(t):m({canvas:t,inputElement:t,pixelRatio:window.devicePixelRatio,lowPerformanceSettings:u()}))}w();
