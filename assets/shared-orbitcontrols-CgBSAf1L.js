import{a as q,l as I,Y as U,A as X,Z as Y,S as J,_ as V,$ as Z,a0 as $,H as F,a1 as K,a2 as Q,m as ee,a3 as te,r as ne,L as se,a4 as ae}from"./vendor-three-kpSP7edE.js";import{H as ie}from"./gainmap-js-DpxNzZ2n.js";import{B as oe,T as re,a as ce,H as le,b as E,c as de,F as pe,E as me,R as ue,d as P}from"./postprocessing-WmxTdlLM.js";var fe="/monk-viewer/assets/McLovin-1024x-DrI75Pld.glb",he="/monk-viewer/assets/old_bus_depot_2k_HDR-CghB0eNo.jpg";function Fe(M){const{canvas:x,inputElement:t,pixelRatio:L}=M,i=new q({powerPreference:"high-performance",antialias:!1,stencil:!1,depth:!1,canvas:x});i.setPixelRatio(L||1),i.outputColorSpace=I,i.toneMapping=U,i.toneMappingExposure=1.5;const R=50,y=2,H=.1,k=100,r=new X(R,y,H,k);r.position.z=.8;const l=new Y(r,t);l.enableDamping=!0,l.dampingFactor=.055,l.target.set(0,0,0),l.update();const d=new J,j=16777215,O=1;new V(j,O).position.set(-10,5,40);let m,h=Date.now(),g;new Z().load(fe,async function(n){const s=n.scene;s.scale.set(1,1,1),s.traverse(a=>{if(a.isMesh){const o=c=>{c&&(c.minFilter=ne,c.magFilter=se,c.anisotropy=i.capabilities.getMaxAnisotropy(),c.generateMipmaps=!0)};o(a.material.map),o(a.material.normalMap),o(a.material.roughnessMap),o(a.material.metalnessMap)}}),await i.compileAsync(s,r,d),m=new $(s),m.clipAction(n.animations[0]),d.add(s),requestAnimationFrame(v)}),new ie(i).load(he,function(n){const s=n.renderTarget.texture;s.type=F,s.needsUpdate=!0,d.environment=s,d.environment.mapping=K,n.dispose()});const C=new oe({luminanceThreshold:.5,luminanceSmoothing:.1,mipmapBlur:!0,intensity:.7,radius:.9}),A=new re({mode:ce.REINHARD,resolution:256,whitePoint:10,middleGrey:.8,minLuminance:.01,averageLuminance:.1,adaptationRate:1});new le({hue:0,saturation:0,blendFunction:E.NORMAL});const D=new de({brightness:0,contrast:.1,blendFunction:E.NORMAL}),S=new pe,u={strength:1.5,threshold:.1,radius:2},B=new Q(new ee(t.clientWidth,t.clientHeight),u.strength,u.radius,u.threshold),p=new me(i,{frameBufferType:F});p.addPass(new ue(d,r));const w=new P(r,S,C);w.dithering=!0,p.addPass(w),p.addPass(new P(r,A,D));const T=1,z=1,G=1;new te(T,z,G);class W{constructor(){this.raycaster=new ae,this.pickedObject=null,this.pickedObjectSavedColor=0}pick(n,s,a,o){this.pickedObject&&(this.pickedObject.material.emissive.setHex(this.pickedObjectSavedColor),this.pickedObject=void 0),this.raycaster.setFromCamera(n,a);const c=this.raycaster.intersectObjects(s.children);c.length&&(this.pickedObject=c[0].object,this.pickedObjectSavedColor=this.pickedObject.material.emissive.getHex(),this.pickedObject.material.emissive.setHex(o*8%2>1?16776960:16711680))}}new W;function N(e){const n=e.domElement,s=t.clientWidth,a=t.clientHeight,o=n.width!==s||n.height!==a;return o&&(e.setSize(s,a,!1),p.setSize(s,a),B.resolution.set(s,a)),o}function v(e){N(i)&&(r.aspect=t.clientWidth/t.clientHeight,r.updateProjectionMatrix()),g=(Date.now()-h)/1e3,m&&m.update(g),l.update(),p.render(),h=Date.now(),requestAnimationFrame(v)}function _(e){const n=t.getBoundingClientRect();return{x:e.clientX-n.left,y:e.clientY-n.top}}function f(e){const n=_(e);n.x/t.clientWidth*2-1,n.y/t.clientHeight*-2+1}function b(){}t.addEventListener("mousemove",f),t.addEventListener("mouseout",b),t.addEventListener("mouseleave",b),t.addEventListener("touchstart",e=>{e.preventDefault(),f(e.touches[0])},{passive:!1}),t.addEventListener("touchmove",e=>{f(e.touches[0])}),t.addEventListener("touchend",e=>{})}export{Fe as i};
