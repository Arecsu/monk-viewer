import{i as d}from"./shared-orbitcontrols-XMsNeJGH.js";import"./vendor-three-B2nca_jY.js";import"./gainmap-js-DC9a5eKy.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function r(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(n){if(n.ep)return;n.ep=!0;const o=r(n);fetch(n.href,o)}})();const c=a(["ctrlKey","metaKey","shiftKey","button","pointerType","clientX","clientY","pointerId","pageX","pageY"]),f=a(["deltaX","deltaY"]),p=a(["ctrlKey","metaKey","shiftKey","keyCode"]);function h(e,t){e.preventDefault(),f(e,t)}function m(e,t){t({type:e.type})}function g(e,t,r){for(const i of t)r[i]=e[i]}function a(e){return function(r,i){const n={type:r.type};g(r,e,n),i(n)}}function l(e,t){e.preventDefault();const r=[],i={type:e.type,touches:r};for(let n=0;n<e.touches.length;++n){const o=e.touches[n];r.push({pageX:o.pageX,pageY:o.pageY,clientX:o.clientX,clientY:o.clientY})}t(i)}const y={37:!0,38:!0,39:!0,40:!0};function v(e,t){const{keyCode:r}=e;y[r]&&(e.preventDefault(),p(e,t))}let w=0;class x{constructor(t,r,i){this.id=w++,this.worker=r,this.element=t;const n=o=>{this.worker.postMessage({type:"event",id:this.id,data:o})};r.postMessage({type:"makeProxy",id:this.id}),this.resizeObserver=new ResizeObserver(o=>{requestAnimationFrame(()=>{const s=this.element.getBoundingClientRect();n({type:"size",left:s.left,top:s.top,width:this.element.clientWidth,height:this.element.clientHeight,pixelRatio:window.devicePixelRatio||1})})}),this.sendSize(n),this.resizeObserver.observe(t);for(const[o,s]of Object.entries(i))t.addEventListener(o,function(u){s(u,n)})}sendSize(t){const r=this.element.getBoundingClientRect();t({type:"size",left:r.left,top:r.top,width:this.element.clientWidth,height:this.element.clientHeight})}disconnect(){this.resizeObserver&&this.resizeObserver.disconnect()}}function P(){const e=/Macintosh(?!.*KHTML).*Gecko/i,t=/Android(?!.*KHTML).*Gecko/i;return e.test(navigator.userAgent)?{disableMSAA:!0,lowResolution:!1}:t.test(navigator.userAgent)?{disableMSAA:!0,lowResolution:!0}:null}function b(e,t){const r=e.transferControlToOffscreen(),i=new Worker(new URL("/monk-viewer/assets/offscreencanvas-worker-orbitcontrol-BWW1lBAi.js",import.meta.url),{type:"module"}),n=window.devicePixelRatio||1,o={contextmenu:m,mousedown:c,mousemove:c,mouseup:c,mouseleave:c,pointerdown:c,pointermove:c,pointerup:c,touchstart:l,touchmove:l,touchend:l,wheel:h,keydown:v},s=new x(e,i,o);i.postMessage({type:"start",canvas:r,canvasId:s.id,pixelRatio:n,lowPerformanceSettings:t},[r]),console.log("using OffscreenCanvas")}function O(e,t){d({canvas:e,inputElement:e,pixelRatio:window.devicePixelRatio,lowPerformanceSettings:t}),console.log("using regular canvas")}function R(){const e=P(),t=document.querySelector("#c");t.transferControlToOffscreen?b(t,e):O(t,e)}R();
