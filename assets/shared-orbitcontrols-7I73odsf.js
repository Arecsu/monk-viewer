import{a as J,m as X,n as N,o as V,S as Y,p as K,q as Q,G as Z,A as $,H as F,r as y,L as M,E as ee,s as te,W as ie,b as ae,t as se,u as ne,v as oe,w as re,x as ce,y as le,z as pe,J as de}from"./vendor-three-B2-nUknm.js";import{H as me}from"./gainmap-js-DON3NsbA.js";var ue="/monk-viewer/assets/McLovin-1024x-DrI75Pld.glb",he="/monk-viewer/assets/old_bus_depot_2k_HDR-CghB0eNo.jpg";function ve(k){let{canvas:L,inputElement:i,pixelRatio:S}=k;const o=new J({powerPreference:"high-performance",antialias:!1,canvas:L});o.setPixelRatio(S||1),o.toneMapping=X,o.toneMappingExposure=1.5;const j=50,H=2,O=.1,E=100,c=new N(j,H,O,E);c.position.z=.8;const d=new V(c,i);d.enableDamping=!0,d.dampingFactor=.055,d.target.set(0,0,0),d.update();const l=new Y,z=16777215,C=1,D=new K(z,C);l.background=new Q(0),D.position.set(-10,5,40);let m,f=Date.now(),v;new Z().load(ue,async function(t){const a=t.scene;a.scale.set(1,1,1),a.traverse(s=>{if(s.isMesh){s.receiveShadow=!1;const r=n=>{n&&(n.minFilter=y,n.magFilter=M,n.anisotropy=o.capabilities.getMaxAnisotropy(),n.generateMipmaps=!0)};r(s.material.map),r(s.material.normalMap),r(s.material.roughnessMap),r(s.material.metalnessMap)}}),await o.compileAsync(a,c,l),m=new $(a),m.clipAction(t.animations[0]),l.add(a),requestAnimationFrame(P)}),new me(o).load(he,function(t){const a=t.renderTarget.texture;a.type=F,a.minFilter=y,a.magFilter=M,a.generateMipmaps=!0,a.needsUpdate=!0,l.environment=a,l.environment.mapping=ee,t.dispose()});const h=o.getDrawingBufferSize(new te),x=new ie(h.width,h.height,{samples:0,anisotropy:o.capabilities.getMaxAnisotropy(),colorSpace:ae,type:F}),p=new se(o,x),A=new ne(l,c);p.addPass(A);const T=new oe(h,.12,.9,.1);p.addPass(T);const W=new re;p.addPass(W);const u=new ce(le);u.material.uniforms.resolution.value.x=1/(i.clientWidth*o.getPixelRatio()),u.material.uniforms.resolution.value.y=1/(i.clientHeight*o.getPixelRatio());const B=1,G=1,q=1;new pe(B,G,q);class _{constructor(){this.raycaster=new de,this.pickedObject=null,this.pickedObjectSavedColor=0}pick(t,a,s,r){this.pickedObject&&(this.pickedObject.material.emissive.setHex(this.pickedObjectSavedColor),this.pickedObject=void 0),this.raycaster.setFromCamera(t,s);const n=this.raycaster.intersectObjects(a.children);n.length&&(this.pickedObject=n[0].object,this.pickedObjectSavedColor=this.pickedObject.material.emissive.getHex(),this.pickedObject.material.emissive.setHex(r*8%2>1?16776960:16711680))}}new _;let w=0;function U(e,t){if(t-w<150)return!1;const a=e.domElement,s=i.clientWidth,r=i.clientHeight,n=i.pixelRatio||window.devicePixelRatio,b=a.width!==Math.floor(s*n)||a.height!==Math.floor(r*n)||n!==e.getPixelRatio();return b&&(e.setPixelRatio(n||1),w=t,e.setSize(s,r,!1),u.material.uniforms.resolution.value.x=1/(s*e.getPixelRatio()),u.material.uniforms.resolution.value.y=1/(r*e.getPixelRatio()),x.setSize(s,r,!1),p.setSize(s,r),p.setPixelRatio(e.getPixelRatio())),b}function P(e){const t=Date.now();U(o,t)&&(c.aspect=i.clientWidth/i.clientHeight,c.updateProjectionMatrix()),v=(t-f)/1e3,m&&m.update(v),d.update(),p.render(),f=t,requestAnimationFrame(P)}function I(e){const t=i.getBoundingClientRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}function g(e){const t=I(e);t.x/i.clientWidth*2-1,t.y/i.clientHeight*-2+1}function R(){}i.addEventListener("mousemove",g),i.addEventListener("mouseout",R),i.addEventListener("mouseleave",R),i.addEventListener("touchstart",e=>{e.preventDefault(),g(e.touches[0])},{passive:!1}),i.addEventListener("touchmove",e=>{g(e.touches[0])}),i.addEventListener("touchend",e=>{})}export{ve as i};
